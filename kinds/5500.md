---
layout: default
title: Malware Scanning
description: Job request to perform a Malware Scan on files.
---

# Input

Clients must provide a URL in the `i` tag field. The desired file(s) to be scanned must be directly accessible at the provided URL.

# Output

A `content` JSON-stringified list of tags containing the information about the malware scan. Service providers MUST include one `result` tag with the value set to `CLEAN` if no malware was found. If malware was found, the content of the `result` tag can be set to anything other than `CLEAN`.

In order to help with discoverability/search, service providers should include an `x` tag set to the SHA256 of the scanned file(s).

The examples show in a clear way the output format.

# Example 1

## Analysis of a file that contains malware.

#### Request

```json
{
  "content": "",
  "kind": 5500,
  "tags": [["i", "https://secure.eicar.org/eicar.com.txt", "url"]]
}
```

#### Response

```json
{
  ...
  "content": '
    ["result", "Scanning eicar.com.txt eicar.com.txt: Win.Test.EICAR_HDB-1 FOUND eicar.com.txt: Win.Test.EICAR_HSB-1 FOUND eicar.com.txt: Eicar-Signature FOUND eicar.com.txt!(0): Eicar-Signature FOUND"],
    ["info", "Files Scanned", "eicar.com.txt", "file2.txt", "<more files scanned here>"],
    ["info", "Viruses Found", "Win.Test.EICAR_HDB-1", "Win.Test.EICAR_HSB-1", "Eicar-Signature"],
    ["x","131f95c51cc819465fa1797f6ccacf9d494aaaff46fa3eac73ae63ffbdfd8267"]
  ',
  "kind": 6500
}
```

# Example 2

## Analysis of a clean file.

#### Request

```json
{
  "content": "",
  "kind": 5500,
  "tags": [
    [
      "i",
      "https://raw.githubusercontent.com/ca110us/go-clamav/main/example/test_file/nmap",
      "url"
    ]
  ]
}
```

#### Response

```json
{
  ...
  "content": '
    ["result", "CLEAN"],
    ["x","cc48d5aec6bd3886a52b0edacb4471d09a3d6df14cec3d5e0b935148c790014c"]
  ',
  "kind": 6500
  ...
}
```
